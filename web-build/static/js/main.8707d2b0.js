(()=>{var e={853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>me});var r=n(5861),o=n(5671),i=n(3144),l=n(136),s=n(2963),a=n(1120),d=n(9526),u=n(3292),c=n(4333),f=n(7301),m=n(5690),h=n(5885),p=n(8138),g=n(5519),y=n(6105),v=n.n(y),x=n(7326),j=n(5202),S=n(1133),b=n(8643),I=n(1451),w=n(9233),R=n(9899);const F={vacant:"#30BEAE",reserved:"#FFB86F",occupied:"#2A79A8",paid:"#E84855",unavailable:"#424549",adhoc:"#7a4988",deposit:"#d65c91",grey1:"#23272A",grey2:"#2C2F33",grey3:"#36393E",grey4:"#424549",grey5:"#99aab5",grey7:"#E3E5E8",grey8:"#EBEDEF",grey9:"#F2F3F5",size:"web"===n(7132).default.OS?5:4,black8:"#000000aa",white8:"#ffffffcc"};const C={fnb:{service:"https://www.epbrowser.com/fnb-ws/",gateway:"https://www.epbrowser.com/gateway/",logo:n(8295),wall:n(3921),login:n(8021),orgId:"X02",locId:"X0201",shopId:"X0201"},yd:{service:"http://192.168.100.120:8085/",gateway:"https://www.epbrowser.com/gateway/",logo:n(8295),wall:n(3921),login:n(8021),orgId:"X02",locId:"X0201",shopId:"X0201"},glow:{service:"http://glow-dempsey.supernature.com.sg:8085/",gateway:"http://42.61.99.129:8090/gateway/",logo:n(8295),wall:n(3921),login:n(8021),orgId:"01",locId:"46",shopId:"SP02"}};var k=n(6459),z=n(9566),O=n(7557);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var D=function(e){(0,l.default)(n,e);var t=T(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={selectedFolderId:""},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){}},{key:"handleViewableChanged",value:function(e){var t=this,n=e.viewableItems;e.changed;if(0!==n.length){var r=null==n?void 0:n[0].section.folderId;r!==this.state.selectedFolderId&&this.setState({selectedFolderId:r},(function(){return t.flatListRef.scrollToIndex({animated:!0,index:t.props.folders.findIndex((function(e){return r===e.folderId}))})}))}}},{key:"doPressFolder",value:function(e){var t=this.props.folders.findIndex((function(t){return t.folderId===e.folderId}));this.props.handlePressFolder(t),this.setState({selectedFolderId:e.folderId})}},{key:"render",value:function(){var e=this;return(0,k.default)(this.props),(0,k.default)(this.state),(0,O.jsx)(S.default,{style:{height:54,backgroundColor:F.grey7,justifyContent:"center"},children:(0,O.jsx)(S.default,{style:{height:50,backgroundColor:F.grey1},children:(0,O.jsx)(z.default,{ref:function(t){return e.flatListRef=t},style:{backgroundColor:F.grey9},showsHorizontalScrollIndicator:!1,horizontal:!0,data:this.props.folders,keyExtractor:function(e){return e.recKey.toString()},renderItem:function(t){var n=t.item;return(0,O.jsxs)(I.default,{style:{padding:20,alignItems:"center",justifyContent:"center",backgroundColor:n.folderId===e.state.selectedFolderId?F.grey8:F.grey9},onPress:function(){return e.doPressFolder(n)},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:16},children:n.name}),("00:00"!==v()(n.startTime,"HH:mm:ss").format("HH:mm")||"23:59"!==v()(n.endTime,"HH:mm:ss").format("HH:mm"))&&(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:12,marginTop:-2},children:[v()(n.startTime,"HH:mm:ss").format("HH:mm")," ~ ",v()(n.endTime,"HH:mm:ss").format("HH:mm")]})]})}})})})}}]),n}(d.Component);c.default.create({});function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var A=function(e){(0,l.default)(n,e);var t=P(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){}));return function(){return e.apply(this,arguments)}}()},{key:"doPressLogo",value:function(){var e,t=this.props,n=t.navigation,r=t.session;null!=(e=r.o)&&e.openorder?n.navigate("Menu"):n.navigate("Start",{e:r.e,t:r.t})}},{key:"doLogout",value:function(){var e,t=this.props,n=t.navigation,r=t.session,o=r,i=null==(e=C[r.e])?void 0:e.service;fetch(i+"api/orders/"+(null==r?void 0:r.o.openorder.recKey)+"/clear-order-vip-info",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderRecKey:null==r?void 0:r.o.openorder.recKey})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.openorder&&(o.o=e,o.v={},g.default.setItem("session",JSON.stringify(o)),n.navigate("Start",{e:r.e,t:r.t}))}))}},{key:"render",value:function(){var e,t,n,r,o,i,l,s,a,d,u,c=this,f=this.props,m=f.navigation,h=(f.route,f.session);return(0,k.default)(this.state),console.log("openorder",null==h||null==(e=h.o)||null==(t=e.openorder)?void 0:t.recKey),(0,O.jsxs)(S.default,{style:{},children:[(0,O.jsxs)(S.default,{style:{height:40,margin:20,marginBottom:0,flexDirection:"row",justifyContent:"space-between"},children:[(0,O.jsx)(I.default,{onPress:function(){return c.doPressLogo()},children:(0,O.jsx)(R.default,{style:{height:40,width:80},source:{uri:null==(n=C.glow)?void 0:n.logo},resizeMode:"contain"})}),(0,O.jsxs)(S.default,{style:{flex:1,flexDirection:"row-reverse"},children:[(0,O.jsx)(I.default,{style:{backgroundColor:F.paid,height:40,width:40,borderRadius:20,marginHorizontal:5,alignItems:"center",justifyContent:"center"},onPress:function(){return m.navigate("Order")},children:(0,O.jsx)(j.default,{name:"clipboard-text",size:22,color:F.grey9})}),(null==h||null==(r=h.o)?void 0:r.openorder)&&(0,O.jsx)(I.default,{style:{backgroundColor:F.reserved,height:40,width:40,borderRadius:20,marginHorizontal:5,alignItems:"center",justifyContent:"center"},onPress:function(){return m.navigate("Cart")},children:(0,O.jsx)(j.default,{name:"shopping",size:22,color:F.grey9})}),null!=h&&null!=(o=h.v)&&o.vipId?(0,O.jsx)(I.default,{style:{backgroundColor:F.grey9,height:40,width:40,borderRadius:20,marginHorizontal:5,alignItems:"center",justifyContent:"center"},onPress:function(){return c.doLogout()},children:(0,O.jsx)(j.default,{name:"crown",size:22,color:F.grey1})}):(0,O.jsx)(I.default,{style:{backgroundColor:F.occupied,height:40,width:40,borderRadius:20,marginHorizontal:5,alignItems:"center",justifyContent:"center"},onPress:function(){return m.navigate("Login")},children:(0,O.jsx)(j.default,{name:"crown",size:22,color:F.grey9})})]})]}),(0,O.jsxs)(S.default,{style:{height:24,flexDirection:"row-reverse",marginHorizontal:20,alignItems:"center"},children:[(0,O.jsx)(w.default,{style:{width:50,fontFamily:"demi",fontSize:10,textAlign:"center",color:F.grey1},children:"ORDER"}),(null==h||null==(i=h.o)?void 0:i.openorder)&&(0,O.jsxs)(w.default,{style:{width:50,fontFamily:"demi",fontSize:10,textAlign:"center",color:F.grey1},children:["CART (",(null==h||null==(l=h.o)||null==(s=l.openorderItems)?void 0:s.length)||0,")"]}),(0,O.jsx)(w.default,{style:{width:50,fontFamily:"demi",fontSize:10,textAlign:"center",color:F.grey1},children:null!=h&&null!=(a=h.v)&&a.vipId?"LOG OUT":"MEMBER"}),(0,O.jsxs)(w.default,{style:{flex:1,fontFamily:"demi",fontSize:10,textAlign:"left",color:F.grey1},children:[null!=h&&h.t?"TABLE "+h.t:"TAKE AWAY","    ",(null==h||null==(d=h.v)||null==(u=d.vipName)?void 0:u.toUpperCase())||"GUEST"]})]})]})}}]),n}(d.Component);c.default.create({});function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var M=function(e){(0,l.default)(n,e);var t=H(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={maps:[],limiteds:[]},r.handlePressFolder=r.handlePressFolder.bind((0,x.default)(r)),r.handleViewableChanged=r.handleViewableChanged.bind((0,x.default)(r)),r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=this,t=yield g.default.getItem("masters"),n=yield g.default.getItem("session");this.setState({masters:JSON.parse(t),session:JSON.parse(n)},(function(){e.doVerify(),e.doGet(),e.doPrepareMasters()}));var r=this.props.navigation;this.sub=r.addListener("focus",this.didFocus.bind(this))}));return function(){return e.apply(this,arguments)}}()},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e=this,t=yield g.default.getItem("session");this.setState({session:JSON.parse(t)},(function(){e.doVerify(),e.doGet()}))}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.sub()}},{key:"doVerify",value:function(){var e=this.props.navigation,t=this.state.session;t.o.openorder||(console.log("verify realised no openorder"),e.navigate("Start",{e:t.e,t:t.t}))}},{key:"doPrepareMasters",value:function(){var e=this.state.masters,t=e.folders;t.forEach((function(t){t.data=e.menus.filter((function(e){return e.folderId===t.folderId&&e.foldergrpId===t.foldergrpId}))})),this.setState({maps:t})}},{key:"doGet",value:function(){var e,t,n,r=this,o=this.props,i=(o.navigation,o.route,this.state.session),l=(null==(e=C[null==i?void 0:i.e])?void 0:e.service)+"api/restmenu-serve",s=new URLSearchParams;s.append("orgId",null==(t=C[i.e])?void 0:t.orgId),s.append("shopId",null==(n=C[i.e])?void 0:n.shopId),fetch(l+="?"+s).then((function(e){return e.json()})).then((function(e){r.setState({limiteds:e})}))}},{key:"handlePressFolder",value:function(e){this.sectionListRef.scrollToLocation({animated:!1,sectionIndex:e,itemIndex:0})}},{key:"handleViewableChanged",value:function(e){e.viewableItems,e.changed}},{key:"doTranslateDisable",value:function(e){var t=this.state.limiteds,n=null==t?void 0:t.find((function(t){return t.restmenuRecKey===e.recKey}));return!v()(new Date,"HH:mm:ss").isBetween(v()(e.startTime,"HH:mm:ss"),v()(e.endTime,"HH:mm:ss"))||("B"===(null==n?void 0:n.statusFlg)||"B"===(null==n?void 0:n.onlineStatusFlg))}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.navigation,i=(r.route,this.state),l=(i.masters,i.maps),s=i.session;return(0,O.jsxs)(S.default,{style:{flex:1,backgroundColor:"white"},children:[(0,O.jsx)(A,{navigation:o,session:s}),(0,O.jsx)(D,{ref:function(e){return n.menuFolderRef=e},folders:null==(e=this.state.masters)?void 0:e.folders,handlePressFolder:this.handlePressFolder}),(0,O.jsx)(b.default,{ref:function(e){return n.sectionListRef=e},onViewableItemsChanged:this.handleViewableChanged,scrollEventThrottle:10,showsVerticalScrollIndicator:!1,sections:l,windowSize:21,keyExtractor:function(e,t){return e.folderMenuRecKey?e.folderMenuRecKey.toString():e.recKey.toString()},renderItem:function(e){var t,r,i=e.item;e.index;return(0,O.jsxs)(S.default,{style:{opacity:n.doTranslateDisable(i)?.5:1,flexDirection:"row",padding:10,borderBottomColor:F.grey9,borderBottomWidth:1,backgroundColor:"white"},children:[(0,O.jsxs)(S.default,{style:{height:80,width:80,borderRadius:5,marginRight:10,overflow:"hidden"},children:[(0,O.jsx)(R.default,{style:{flex:1},source:{uri:null==(t=C[null==s?void 0:s.e])?void 0:t.wall},resizeMode:"cover"}),(0,O.jsx)(R.default,{style:{position:"absolute",left:0,right:0,bottom:0,top:0},source:{uri:(null==(r=C[null==s?void 0:s.e])?void 0:r.gateway)+"epbm/api/image/stock?stkId="+i.stkId+"&skuId=&t="+i.lastupdate},resizeMode:"cover"})]}),(0,O.jsxs)(I.default,{style:{flex:1},disabled:n.doTranslateDisable(i),onPress:function(){return o.navigate("Item",{m:i.recKey.toString()})},children:[(0,O.jsx)(S.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:18,color:F.grey1},children:i.menuName})}),(0,O.jsx)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:i.menuNameLang}),i.menuRemark&&(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:14,color:F.grey1,marginTop:5},children:i.menuRemark}),(0,O.jsx)(S.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:16,marginTop:10,color:F.grey1},children:[i.listPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),"   "]})})]})]})},renderSectionHeader:function(e){var t,n,r=e.section;return(0,O.jsxs)(S.default,{style:{borderBottomWidth:1,borderBottomColor:F.grey8,backgroundColor:"white"},children:[(0,O.jsxs)(S.default,{style:{height:120,width:"100%"},children:[(0,O.jsx)(R.default,{style:{flex:1},source:{uri:null==(t=C[null==s?void 0:s.e])?void 0:t.wall},resizeMode:"cover"}),(0,O.jsx)(R.default,{style:{position:"absolute",left:0,right:0,bottom:0,top:0},source:{uri:(null==(n=C[null==s?void 0:s.e])?void 0:n.gateway)+"epbm/api/image/stock?stkId="+r.folderId+"&isResourceId=true&skuId=&t="+r.lastupdate},resizeMode:"cover"})]}),(0,O.jsxs)(S.default,{style:{padding:10,paddingTop:40,paddingBottom:30},children:[(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:20,color:F.grey1},children:[r.name,"  ",(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:["(",r.data.length,")"]})]}),"00:00"!==v()(r.startTime,"HH:mm:ss").format("HH:mm")||"23:59"!==v()(r.endTime,"HH:mm:ss").format("HH:mm")?(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1,paddingHorizontal:10},children:[(0,O.jsx)(j.default,{name:"timer-outline",color:"black"})," available ",v()(r.startTime,"HH:mm:ss").format("HH:mm")," ~ ",v()(r.endTime,"HH:mm:ss").format("HH:mm")," only"]}):(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1,paddingHorizontal:10},children:[(0,O.jsx)(j.default,{name:"timer-outline",color:"black"})," available all day"]})]})]})},renderSectionFooter:function(e){e.section;return(0,O.jsx)(S.default,{style:{marginTop:20,marginBottom:60}})}},null==s||null==(t=s.o)?void 0:t.openorder.recKey)]})}}]),n}(d.Component),N=(c.default.create({}),n(2640)),B=n(3497),K=n(8859);function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var E=function(e){(0,l.default)(n,e);var t=L(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={remark:"",orderQty:1,modRecKeys:[]},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e,t,n,r,o=this.props.route,i=yield g.default.getItem("masters");i=JSON.parse(i);var l=yield g.default.getItem("session");l=JSON.parse(l);var s=i.menus.find((function(e){return e.recKey.toString()===o.params.m}));this.setState({masters:i,session:l,selectedMenu:s,selectedItem:o.params.i?l.o.openorderItems.find((function(e){return e.recKey.toString()===o.params.i})):null,mods:i.mods.filter((function(e){return e.menuId===s.menuId})),remark:o.params.i&&(null==(e=l.o.openorderItems.find((function(e){return e.recKey.toString()===o.params.i})))?void 0:e.menuMod)||"",orderQty:o.params.i?null==(t=l.o.openorderItems.find((function(e){return e.recKey.toString()===o.params.i})))?void 0:t.orderQty:1,modRecKeys:o.params.i&&(null==(n=l.o.openorderItems.find((function(e){return e.recKey.toString()===o.params.i})))||null==(r=n.modRecKeys)?void 0:r.split(","))||[]})}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"doPressAdd",value:function(){var e=this.state.orderQty;this.setState({orderQty:e+1})}},{key:"doPressMinus",value:function(){var e=this.state.orderQty;e<=1||this.setState({orderQty:e-1})}},{key:"doPressMod",value:function(e){var t=this.state,n=t.masters,r=t.modRecKeys,o=n.modBundles.find((function(t){return t.modmas.modId===e.modId})),i=r;"A"===o.modmas.modType?r.some((function(t){return t===e.recKey.toString()}))?i=i.filter((function(t){return t!==e.recKey.toString()})):i.push(e.recKey.toString()):(o.moditems.forEach((function(e){i=i.filter((function(t){return t!==e.recKey.toString()}))})),r.some((function(t){return t===e.recKey.toString()}))||i.push(e.recKey.toString())),this.setState({modRecKeys:i})}},{key:"doSubmit",value:function(){var e=(0,r.default)((function*(){var e,t=this.props,n=t.navigation,r=t.route,o=this.state,i=(o.masters,o.session),l=o.orderQty,s=o.remark,a=o.modRecKeys,d=(o.selectedMenu,i),u=null==(e=C[i.e])?void 0:e.service;fetch(u+"api/"+(r.params.i?"update":"create")+"-openorder-item/"+(null==i?void 0:i.o.openorder.recKey),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderItemRecKey:r.params.i,restmenuRecKey:r.params.m,orderQty:l,restmenuMod:s,modRecKeys:a.join(",")})}).then((function(e){return e.json()})).then((function(e){e.errMsg?K.default.alert(e.errMsg):e.openorder&&(d.o=e,g.default.setItem("session",JSON.stringify(d)),r.params.i?n.navigate("Cart"):n.navigate("Menu"))}))}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n=this,r=this.props,o=(r.navigation,r.route),i=this.state,l=i.masters,s=i.session,a=i.remark,d=i.orderQty,u=i.selectedMenu,c=i.mods,f=i.modRecKeys;return console.log("selectedmenu",u),(0,O.jsxs)(S.default,{style:{backgroundColor:"white",minHeight:window.innerHeight,justifyContent:"space-between"},children:[(0,O.jsxs)(S.default,{children:[(0,O.jsxs)(S.default,{style:{height:200,width:"100%"},children:[(0,O.jsx)(R.default,{style:{flex:1},source:{uri:null==(e=C[null==s?void 0:s.e])?void 0:e.wall},resizeMode:"cover"}),(0,O.jsx)(R.default,{style:{position:"absolute",left:0,right:0,bottom:0,top:0},source:{uri:(null==(t=C[null==s?void 0:s.e])?void 0:t.gateway)+"epbm/api/image/stock?stkId="+(null==u?void 0:u.stkId)+"&skuId=&t="+(null==u?void 0:u.lastupdate)},resizeMode:"cover"})]}),(0,O.jsxs)(S.default,{style:{borderBottomWidth:1,borderBottomColor:F.grey8,paddingVertical:20,paddingHorizontal:10},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,color:F.grey1},children:null==u?void 0:u.menuName}),(null==u?void 0:u.menuNameLang)&&(0,O.jsx)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:null==u?void 0:u.menuNameLang}),(null==u?void 0:u.menuRemark)&&(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:14,color:F.grey1,marginTop:5},children:null==u?void 0:u.menuRemark}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:16,marginTop:10,color:F.grey1},children:null==u?void 0:u.listPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),null==c?void 0:c.map((function(e){var t,r,o;return(0,O.jsxs)(S.default,{style:{paddingVertical:30,paddingHorizontal:10},children:[(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:18,marginBottom:5},children:[e.name,(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:["Y"===(null==(t=l.modBundles.find((function(t){return t.modmas.modId===e.modId})))?void 0:t.modmas.mustFlg)?"  compulsory, ":"  optional, ","A"===(null==(r=l.modBundles.find((function(t){return t.modmas.modId===e.modId})))?void 0:r.modmas.modType)?"select any":"choose one"]})]}),null==(o=l.modBundles.find((function(t){return t.modmas.modId===e.modId})))?void 0:o.moditems.map((function(e,t){return(0,O.jsxs)(I.default,{style:{flexDirection:"row",alignItems:"center",minHeight:40,opacity:e.menuId&&!l.menus.some((function(t){return t.menuId===e.menuId}))?.5:1},disabled:e.menuId&&!l.menus.some((function(t){return t.menuId===e.menuId})),onPress:function(){return n.doPressMod(e)},children:[(0,O.jsx)(S.default,{style:{height:20,width:20,borderRadius:10,backgroundColor:f.some((function(t){return t===e.recKey.toString()}))?F.grey3:F.grey9,margin:10,marginTop:8}}),(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:15},children:[e.name," ",0!==e.listPrice&&"+"+e.listPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},e.recKey.toString())}))]},e.recKey.toString())})),(0,O.jsxs)(S.default,{style:{paddingVertical:30,paddingHorizontal:10},children:[(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:18,marginBottom:5},children:["Remarks",(0,O.jsx)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:"  additional comments"})]}),(0,O.jsx)(B.default,{style:{marginTop:5,borderRadius:5,backgroundColor:F.grey9,minHeight:50,fontFamily:"regular",fontSize:16,padding:5},multiline:!0,onChangeText:function(e){return n.setState({remark:e})},value:a})]})]}),(0,O.jsx)(S.default,{style:{marginTop:140}}),(0,O.jsxs)(S.default,{style:{position:"fixed",backgroundColor:"white",bottom:0,left:0,right:0,shadowColor:F.grey1,shadowOffset:{width:0,height:-2},shadowOpacity:.2,shadowRadius:20},children:[(0,O.jsxs)(S.default,{style:{flexDirection:"row",height:60,backgroundColor:"white"},children:[(0,O.jsx)(I.default,{style:{flex:1,alignItems:"flex-end",justifyContent:"center"},onPress:function(){return n.doPressMinus()},children:(0,O.jsx)(N.default,{name:"minus",size:24,color:F.grey1})}),(0,O.jsx)(S.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:24,color:F.grey1},children:d})}),(0,O.jsx)(I.default,{style:{flex:1,alignItems:"flex-start",justifyContent:"center"},onPress:function(){return n.doPressAdd()},children:(0,O.jsx)(N.default,{name:"plus",size:24,color:F.grey1})})]}),(0,O.jsx)(I.default,{style:{margin:10,height:60,borderRadius:5,backgroundColor:F.grey8,alignItems:"center",justifyContent:"center",opacity:null!=l&&l.modBundles.filter((function(e){return"Y"===e.modmas.mustFlg&&("Y"===e.modmas.globalFlg||c.some((function(t){return t.menuId===u.menuId&&t.modId===e.modmas.modId})))})).some((function(e){return!e.moditems.some((function(e){return f.some((function(t){return t===e.recKey.toString()}))}))}))?.2:1},disabled:null==l?void 0:l.modBundles.filter((function(e){return"Y"===e.modmas.mustFlg&&("Y"===e.modmas.globalFlg||c.some((function(t){return t.menuId===u.menuId&&t.modId===e.modmas.modId})))})).some((function(e){return!e.moditems.some((function(e){return f.some((function(t){return t===e.recKey.toString()}))}))})),onPress:function(){return n.doSubmit()},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:2,color:F.grey1},children:o.params.i?"EDIT":"ADD"})})]})]})}}]),n}(d.Component);c.default.create({modifierTextInput:{fontFamily:"varela-round",fontSize:20,color:"white",paddingHorizontal:20,height:120,backgroundColor:F.grey3},menuQtyRow:{height:80,flexDirection:"row",justifyContent:"center",alignItems:"center"},menuQtyRowFirst:{flex:1,flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginRight:10},menuQtyRowSecond:{flex:1,justifyContent:"center",alignItems:"center"},menuQtyRowThird:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:10},qtyTextInput:{fontFamily:"varela-round",fontSize:32,width:"100%",color:"white",textAlign:"center"},modContainer:{padding:5,flexDirection:"row",flexWrap:"wrap",justifyContent:"center",backgroundColor:F.grey4},modButton:{paddingHorizontal:20,minHeight:32,justifyContent:"center",borderRadius:16,backgroundColor:F.grey2,margin:5},modText:{fontFamily:"varela-round",color:"white",fontSize:20}});function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var U=function(e){(0,l.default)(n,e);var t=J(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e,t,n,r,o,i,l,s,a,d=this.props,u=d.selectedOrder,c=d.masters;return(0,k.default)(this.state),console.log(u,c),(0,O.jsxs)(S.default,{children:[(0,O.jsxs)(S.default,{style:{padding:10,paddingTop:20,flexDirection:"row",borderBottomWidth:1,borderBottomColor:F.grey8,backgroundColor:"white",alignItems:"baseline",justifyContent:"space-between"},children:[(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:20,color:F.grey1},children:["Order #",u.openorder.docNo]}),(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:12,color:F.grey1},children:["A"===u.openorder.orderType?"TABLE "+u.openorder.tableId:"TAKE AWAY","  ",v()(u.openorder.createDate).format("YYYY-MM-DD  HH:mm")]})]}),(0,O.jsx)(S.default,{style:{marginTop:10}}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10},children:[(0,O.jsx)(w.default,{style:{textAlign:"center",width:40,fontFamily:"demi",fontSize:12,color:F.grey4},children:"Qty"}),(0,O.jsx)(S.default,{style:{flex:1},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:12,color:F.grey4},children:"Item"})}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:12,color:F.grey4},children:"S$"})]}),null==(e=u.openorderItems)?void 0:e.map((function(e){var t;return(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10},children:[(0,O.jsx)(w.default,{style:{textAlign:"center",width:40,fontFamily:"demi",fontSize:18},children:e.orderQty}),(0,O.jsxs)(S.default,{style:{flex:1},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:18},children:e.menuName}),(null==(t=e.menuMod)?void 0:t.length)>0&&(0,O.jsx)(w.default,{style:{fontFamily:"regular",fontSize:16},children:e.menuMod}),u.openorderItemMods.filter((function(t){return t.masRecKey===e.recKey})).map((function(e,t){return(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:["- ",e.name]},t.toString())}))]}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:18},children:e.lineTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]},e.recKey.toString())})),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Discount"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==(t=session)||null==(n=t.o)||null==(r=n.openorder)?void 0:r.totalDisc.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Service Charge"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==u||null==(o=u.openorder)?void 0:o.serviceCharge.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",paddingHorizontal:10,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:18},children:"Total"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:20},children:null==u||null==(i=u.openorder)?void 0:i.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Tax Incl."}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==u||null==(l=u.openorder)?void 0:l.totalTax.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsx)(S.default,{style:{marginTop:20}}),null==u||null==(s=u.openorderPospays)?void 0:s.map((function(e){var t;return(0,O.jsxs)(S.default,{style:{flexDirection:"row",paddingHorizontal:10,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"P"===(null==(t=c.paymentMethods.find((function(t){return t.pmId===e.pmId})))?void 0:t.refType)?"Redeem":"Online Payment"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:e.payMoney.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]},e.recKey.toString())})),(0,O.jsx)(S.default,{style:{marginTop:20}}),(null==u||null==(a=u.openorder)?void 0:a.balance)>0?(0,O.jsx)(w.default,{style:{fontFamily:"regular",marginHorizontal:20},children:"Your order will be sent once payment has been confirmed."}):(0,O.jsx)(w.default,{style:{fontFamily:"regular",marginHorizontal:20},children:"Payment complete. We have received your order!"})]})}}]),n}(d.Component);c.default.create({});function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var Q=function(e){(0,l.default)(n,e);var t=V(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=this.props,t=e.navigation,n=(e.route,yield g.default.getItem("masters")),r=yield g.default.getItem("session");this.setState({session:JSON.parse(r),masters:JSON.parse(n)}),this.sub=t.addListener("focus",this.didFocus.bind(this))}));return function(){return e.apply(this,arguments)}}()},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e=yield g.default.getItem("masters"),t=yield g.default.getItem("session");this.setState({session:JSON.parse(t),masters:JSON.parse(e)})}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.sub()}},{key:"render",value:function(){var e,t=this.props,n=t.navigation,r=(t.route,this.state),o=r.masters,i=r.session;return console.log("render",null==i?void 0:i.h),(0,O.jsxs)(S.default,{style:{backgroundColor:"white",minHeight:window.innerHeight},children:[(0,O.jsx)(A,{navigation:n,session:i}),null==i||null==(e=i.h)?void 0:e.map((function(e){return(0,O.jsx)(U,{selectedOrder:e,masters:o},e.openorder.recKey)}))]})}}]),n}(d.Component);c.default.create({modifierTextInput:{fontFamily:"varela-round",fontSize:20,color:"white",paddingHorizontal:20,height:120,backgroundColor:F.grey3},menuQtyRow:{height:80,flexDirection:"row",justifyContent:"center",alignItems:"center"},menuQtyRowFirst:{flex:1,flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginRight:10},menuQtyRowSecond:{flex:1,justifyContent:"center",alignItems:"center"},menuQtyRowThird:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:10},qtyTextInput:{fontFamily:"varela-round",fontSize:32,width:"100%",color:"white",textAlign:"center"},modContainer:{padding:5,flexDirection:"row",flexWrap:"wrap",justifyContent:"center",backgroundColor:F.grey4},modButton:{paddingHorizontal:20,minHeight:32,justifyContent:"center",borderRadius:16,backgroundColor:F.grey2,margin:5},modText:{fontFamily:"varela-round",color:"white",fontSize:20}});function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var Y=function(e){(0,l.default)(n,e);var t=W(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={loading:!1,emailReceiptFlg:"Y",email:""},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=yield g.default.getItem("session");e&&(e=JSON.parse(e));var t=yield g.default.getItem("masters");t&&(t=JSON.parse(t)),this.setState({session:e,masters:t,email:e.o.openorder.emailAddr,emailReceiptFlg:e.o.openorder.emailReceiptFlg});var n=this.props.navigation;this.sub=n.addListener("focus",this.didFocus.bind(this))}));return function(){return e.apply(this,arguments)}}()},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e=yield g.default.getItem("session");e&&(e=JSON.parse(e)),this.setState({session:e})}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.sub()}},{key:"doRemove",value:function(e){var t,n=this,r=this.props,o=(r.navigation,r.route,this.state),i=(o.masters,o.session),l=(o.orderQty,o.remark,o.modRecKeys,o.selectedMenu,i),s=null==(t=C[i.e])?void 0:t.service;fetch(s+"api/delete-openorder-item/"+(null==i?void 0:i.o.openorder.recKey),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderItemRecKey:e.recKey})}).then((function(e){return e.json()})).then((function(e){e.errMsg?K.default.alert(e.errMsg):e.openorder&&(l.o=e,g.default.setItem("session",JSON.stringify(l)),n.setState({session:l}))}))}},{key:"doRedeem",value:function(){var e=this,t=this.props,n=(t.route,t.navigation,this.state),r=n.masters,o=n.session,i=n.email,l=n.emailReceiptFlg,s=C[o.e].service;this.setState({loading:!0},(function(){fetch(s+"api/email-receipt",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderRecKey:o.o.openorder.recKey,emailAddr:i,receiptFlg:l})}).then((function(e){return e.json()})).then((function(t){var n,i,l,a,d,u;fetch(s+"api/create-openorder-payment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderRecKey:null==(n=o.o)?void 0:n.openorder.recKey,pmId:null==(i=r.paymentMethods.find((function(e){return"P"===e.refType})))?void 0:i.pmId,amt:Math.floor(Math.min(null==(l=o.o)||null==(a=l.openorder)?void 0:a.balance,null==(d=o.o)||null==(u=d.openorder)?void 0:u.vipPtsMoney)),payRef:""})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.doGet()}))}))}))}},{key:"doPay",value:function(){var e=(0,r.default)((function*(){this.props.route;var e=this.state,t=e.session,n=e.email,r=e.emailReceiptFlg,o=yield f.default.getInitialURL(),i=C[t.e].service;this.setState({loading:!0},(function(){fetch(i+"api/email-receipt",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderRecKey:t.o.openorder.recKey,emailAddr:n,receiptFlg:r})}).then((function(e){return e.json()})).then((function(e){var n,r;window.location.href=i+"api/order/"+(null==(n=t.o)?void 0:n.openorder.recKey)+"/redirect-to-payment-url?backUrl="+encodeURIComponent(o.split("bistro-ext")[0]+"bistro-ext/start?e="+t.e+"&t="+t.t)+"&redirectUrl="+encodeURIComponent(o.split("bistro-ext")[0]+"bistro-ext/redirect?e="+t.e+"&t="+t.t+"&r="+(null==(r=t.o)?void 0:r.openorder.recKey))+"&notifyUrl="+encodeURIComponent(i+"api/order/on-notify")}))}))}));return function(){return e.apply(this,arguments)}}()},{key:"doGet",value:function(){var e,t,n,r=this,o=this.props,i=o.navigation,l=(o.route,this.state.session),s=null==(e=C[null==l?void 0:l.e])?void 0:e.service,a=l;fetch(s+"api/openorders/"+(null==l||null==(t=l.o)||null==(n=t.openorder)?void 0:n.recKey)).then((function(e){return e.json()})).then((function(e){if(e.openorder){if(0===e.openorder.balance&&e.openorderPospays.length>0)return void i.navigate("Result",{e:l.e,t:l.t,r:e.openorder.recKey,s:"0"});a.o=e,g.default.setItem("session",JSON.stringify(a)),r.setState({session:a,loading:!1})}}))}},{key:"render",value:function(){var e,t,n,r,o,i,l,s,a,d,u,c,f,m,h,p,g,y,v,x,j,b,R,C,k,z,T,D,P,H,M,K,L,E=this,J=this.props,U=J.navigation,V=(J.route,this.state),Q=V.loading,W=V.masters,Y=V.session,_=V.email,q=V.emailReceiptFlg;return console.log(null==Y?void 0:Y.o),(0,O.jsxs)(S.default,{style:{backgroundColor:"white",minHeight:window.innerHeight,justifyContent:"space-between"},children:[(0,O.jsxs)(S.default,{children:[(0,O.jsx)(A,{navigation:U,session:Y}),(0,O.jsx)(S.default,{style:{borderBottomWidth:1,borderBottomColor:F.grey8,backgroundColor:"white"},children:(0,O.jsxs)(w.default,{style:{fontFamily:"demi",padding:10,fontSize:20,color:F.grey1,paddingTop:20},children:["My Cart ",null==Y?void 0:Y.o.openorder.recKey," ",(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:["(",(null==Y||null==(e=Y.o)||null==(t=e.openorderItems)?void 0:t.length)||"0",")"]})]})}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10},children:[(0,O.jsx)(w.default,{style:{textAlign:"center",width:40,fontFamily:"demi",fontSize:12,color:F.grey4},children:"Qty"}),(0,O.jsx)(S.default,{style:{flex:1},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:12,color:F.grey4},children:"Item"})}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:12,color:F.grey4},children:"S$"})]}),null==Y||null==(n=Y.o)||null==(r=n.openorderItems)?void 0:r.map((function(e,t){var n,r;return(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10},children:[(0,O.jsx)(w.default,{style:{textAlign:"center",width:40,fontFamily:"demi",fontSize:18},children:e.orderQty}),(0,O.jsxs)(S.default,{style:{flex:1},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:18},children:e.menuName}),(null==(n=e.menuMod)?void 0:n.length)>0&&(0,O.jsx)(w.default,{style:{fontFamily:"regular",fontSize:16},children:e.menuMod}),null==Y||null==(r=Y.o)?void 0:r.openorderItemMods.filter((function(t){return t.masRecKey===e.recKey})).map((function(e,t){return(0,O.jsxs)(w.default,{style:{fontFamily:"regular",fontSize:16,color:F.grey1},children:["- ",e.name]},t.toString())})),(0,O.jsxs)(S.default,{style:{flexDirection:"row"},children:[(0,O.jsx)(I.default,{style:{marginTop:10,width:100},onPress:function(){return E.doRemove(e)},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:16,color:F.paid},children:"Remove"})}),(0,O.jsx)(I.default,{style:{marginTop:10,width:100},onPress:function(){return U.navigate("Item",{m:e.restmenuRecKey.toString(),i:e.recKey.toString()})},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:16,color:F.grey1},children:"Edit"})})]})]}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:18},children:e.lineTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]},e.recKey.toString())})),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Subtotal"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==Y||null==(o=Y.o)||null==(i=o.openorder)?void 0:i.beforeDisc.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),((null==Y||null==(l=Y.o)||null==(s=l.openorder)?void 0:s.totalDisc)||0)>0&&(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Discount"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==Y||null==(a=Y.o)||null==(d=a.openorder)?void 0:d.totalDisc.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Service Charge"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==Y||null==(u=Y.o)||null==(c=u.openorder)?void 0:c.serviceCharge.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",paddingHorizontal:10,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:18},children:"Total"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:20},children:null==Y||null==(f=Y.o)||null==(m=f.openorder)?void 0:m.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",padding:10,paddingVertical:5,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"Tax Incl."}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:null==Y||null==(h=Y.o)||null==(p=h.openorder)?void 0:p.totalTax.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,O.jsx)(S.default,{style:{marginTop:20}}),null==Y||null==(g=Y.o)||null==(y=g.openorderPospays)?void 0:y.map((function(e){var t;return(0,O.jsxs)(S.default,{style:{flexDirection:"row",paddingHorizontal:10,alignItems:"baseline"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",flex:1,textAlign:"right",fontSize:14},children:"P"===(null==(t=W.paymentMethods.find((function(t){return t.pmId===e.pmId})))?void 0:t.refType)?"Redeem":"Online Payment"}),(0,O.jsx)(w.default,{style:{textAlign:"right",width:80,fontFamily:"demi",fontSize:14},children:e.payMoney.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]},e.recKey.toString())})),(0,O.jsx)(S.default,{style:{marginTop:20}})]}),0!==(null==Y||null==(v=Y.o)||null==(x=v.openorder)?void 0:x.balance)&&(0,O.jsxs)(S.default,{children:[(0,O.jsxs)(I.default,{style:{marginHorizontal:20,marginTop:20,flexDirection:"row",alignItems:"center"},onPress:function(){return E.setState({emailReceiptFlg:"Y"===q?"N":"Y"})},children:["Y"===q?(0,O.jsx)(N.default,{name:"checksquare",size:20,color:F.grey1}):(0,O.jsx)(N.default,{name:"checksquareo",size:20,color:F.grey9}),(0,O.jsx)(w.default,{style:{fontFamily:"regular",marginLeft:10},children:"Email me the receipt"})]}),(0,O.jsx)(S.default,{style:G.searchContainer,children:(0,O.jsx)(B.default,{style:G.searchTextInput,autoCorrect:!1,placeholder:"email",placeholderTextColor:F.grey5,defaultValue:_,onChangeText:function(e){return E.setState({email:e})}})}),(0,O.jsxs)(S.default,{style:{flexDirection:"row",margin:10},children:[Math.floor(Math.min(null==Y||null==(j=Y.o)||null==(b=j.openorder)?void 0:b.balance,null==Y||null==(R=Y.o)||null==(C=R.openorder)?void 0:C.vipPtsMoney))>0&&(0,O.jsx)(I.default,{style:{flex:1,height:40,margin:10,borderRadius:20,backgroundColor:F.occupied,justifyContent:"center",alignItems:"center"},activeOpacity:1,disabled:Q,onPress:function(){return E.doRedeem()},children:(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:18,color:"white"},children:["Redeem ",Math.floor(Math.min(null==Y||null==(k=Y.o)||null==(z=k.openorder)?void 0:z.balance,null==Y||null==(T=Y.o)||null==(D=T.openorder)?void 0:D.vipPtsMoney)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})}),(null==Y||null==(P=Y.o)||null==(H=P.openorder)?void 0:H.balance)>0&&(0,O.jsx)(I.default,{style:{flex:1,height:40,margin:10,borderRadius:20,backgroundColor:F.paid,justifyContent:"center",alignItems:"center",opacity:Q?.5:1},activeOpacity:1,disabled:Q,onPress:function(){return E.doPay()},children:(0,O.jsxs)(w.default,{style:{fontFamily:"demi",fontSize:18,color:"white"},children:["Pay S$",null==Y||null==(M=Y.o)||null==(K=M.openorder)||null==(L=K.balance)?void 0:L.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})]})]})}}]),n}(d.Component),G=c.default.create({searchContainer:{height:50,borderRadius:5,backgroundColor:F.grey9,flexDirection:"row",margin:10},searchIconContainer:{marginVertical:10,marginHorizontal:5,width:40,alignItems:"center",justifyContent:"center",borderRightWidth:1,borderRightColor:F.grey7},searchTextInput:{flex:1,paddingHorizontal:10,borderRadius:5,fontFamily:"regular",fontSize:20},modifierTextInput:{fontFamily:"varela-round",fontSize:20,color:"white",paddingHorizontal:20,height:120,backgroundColor:F.grey3},menuQtyRow:{height:80,flexDirection:"row",justifyContent:"center",alignItems:"center"},menuQtyRowFirst:{flex:1,flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginRight:10},menuQtyRowSecond:{flex:1,justifyContent:"center",alignItems:"center"},menuQtyRowThird:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:10},qtyTextInput:{fontFamily:"varela-round",fontSize:32,width:"100%",color:"white",textAlign:"center"},modContainer:{padding:5,flexDirection:"row",flexWrap:"wrap",justifyContent:"center",backgroundColor:F.grey4},modButton:{paddingHorizontal:20,minHeight:32,justifyContent:"center",borderRadius:16,backgroundColor:F.grey2,margin:5},modText:{fontFamily:"varela-round",color:"white",fontSize:20}}),_=n(4942),q=n(2982);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,_.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var ee=function(e){(0,l.default)(n,e);var t=Z(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={loading:!0},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e,t,n,r,o,i,l,s=this,a=this.props,d=a.navigation,u=a.route;if(this.sub=d.addListener("focus",this.didFocus.bind(this)),null!=(e=u.params)&&e.e){this.doGet();var c=yield g.default.getItem("session");c&&(c=JSON.parse(c)),console.log("before",c),c={e:u.params.e,t:u.params.t||"",o:((null==(t=c)||null==(n=t.o)||null==(r=n.openorder)?void 0:r.tableId)||"")===(u.params.t||"")?null==(o=c)?void 0:o.o:{},h:(null==(i=c)?void 0:i.h)||[],v:(null==(l=c)?void 0:l.v)||{}},console.log("after",c),g.default.setItem("session",JSON.stringify(c)),this.setState({session:c},(function(){return s.doVerify()}))}else d.navigate("Error")}));return function(){return e.apply(this,arguments)}}()},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e=this.props,t=(e.navigation,e.route,yield g.default.getItem("session"));t&&(t=JSON.parse(t)),this.setState({session:t})}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.sub()}},{key:"doGet",value:function(){var e,t,n,r,o,i,l,s,a,d,u,c,f=this.props,m=f.route;f.navigation;(0,k.default)(this.state);var h,p,y,v=C[m.params.e].service,x=[];h=v+"api/folders-online",(p=new URLSearchParams).append("orgId",null==(e=C[m.params.e])?void 0:e.orgId),p.append("shopId",null==(t=C[m.params.e])?void 0:t.shopId),y={url:h+="?"+p,nameString:"folders"},x.push(y),h=v+"api/menus-online",(p=new URLSearchParams).append("orgId",null==(n=C[m.params.e])?void 0:n.orgId),p.append("shopId",null==(r=C[m.params.e])?void 0:r.shopId),y={url:h+="?"+p,nameString:"menus"},x.push(y),h=v+"api/mods",(p=new URLSearchParams).append("orgId",null==(o=C[m.params.e])?void 0:o.orgId),p.append("shopId",null==(i=C[m.params.e])?void 0:i.shopId),y={url:h+="?"+p,nameString:"mods"},x.push(y),h=v+"api/mod-bundles",(p=new URLSearchParams).append("orgId",null==(l=C[m.params.e])?void 0:l.orgId),p.append("shopId",null==(s=C[m.params.e])?void 0:s.shopId),y={url:h+="?"+p,nameString:"modBundles"},x.push(y),h=v+"api/payment-methods",(p=new URLSearchParams).append("orgId",null==(a=C[m.params.e])?void 0:a.orgId),p.append("shopId",null==(d=C[m.params.e])?void 0:d.shopId),y={url:h+="?"+p,nameString:"paymentMethods"},x.push(y),h=v+"api/settings",(p=new URLSearchParams).append("appCode","RESTMENU"),p.append("orgId",null==(u=C[m.params.e])?void 0:u.orgId),p.append("shopId",null==(c=C[m.params.e])?void 0:c.shopId),y={url:h+="?"+p,nameString:"settings"},x.push(y),Promise.all((0,q.default)(x.map((function(e){return fetch(e.url).then((function(e){return e.json()})).then((function(t){return console.log("fetching",e.nameString,t),(0,_.default)({},e.nameString,t)}))})))).then((function(e){var t=e.reduce((function(e,t){return $($({},e),{},(0,_.default)({},Object.keys(t)[0],Object.values(t)[0]))}),{});console.log("masters",t),g.default.setItem("masters",JSON.stringify(t))}))}},{key:"doVerify",value:function(){var e,t,n,r=this,o=this.props,i=(o.route,o.navigation,this.state.session);if(null==(e=i.o)||!e.openorder||v()().diff(v()(null==i||null==(t=i.o)||null==(n=t.openorder)?void 0:n.seatTime),"minutes")>30){var l,s,a,d,u,c,f,m,h,p,y,x=i,j=null==(l=C[i.e])?void 0:l.service;console.log(JSON.stringify({orgId:null==(s=C[i.e])?void 0:s.orgId,locId:null==(a=C[i.e])?void 0:a.locId,shopId:null==(d=C[i.e])?void 0:d.shopId,tableId:i.t||"",vipId:(null==(u=i.v)?void 0:u.vipId)||"",vipName:(null==(c=i.v)?void 0:c.vipName)||""})),fetch(j+"api/create-openorder",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({orgId:null==(f=C[i.e])?void 0:f.orgId,locId:null==(m=C[i.e])?void 0:m.locId,shopId:null==(h=C[i.e])?void 0:h.shopId,tableId:i.t||"",vipId:(null==(p=i.v)?void 0:p.vipId)||"",vipName:(null==(y=i.v)?void 0:y.vipName)||""})}).then((function(e){return e.json()})).then((function(e){e.message?console.log(e):e.openorder&&(x.o=e,g.default.setItem("session",JSON.stringify(x)),r.setState({session:x,loading:!1}))}))}else this.setState({loading:!1})}},{key:"doStart",value:function(){}},{key:"render",value:function(){var e,t,n,r,o,i=this.props,l=i.navigation,s=i.route,a=this.state,d=a.session;if(!a.loading)return(0,O.jsxs)(S.default,{style:{flex:1,backgroundColor:"white"},children:[(0,O.jsx)(A,{navigation:l,session:d}),(0,O.jsx)(S.default,{style:{position:"absolute",top:80,left:0,right:0,bottom:100},children:(0,O.jsx)(R.default,{style:{flex:1},source:{uri:null==(e=C[null==(t=s.params)?void 0:t.e])?void 0:e.wall},resizeMode:"cover"})}),null!=(n=s.params)&&n.t?(0,O.jsx)(S.default,{style:{position:"absolute",left:0,right:0,bottom:120,height:60,alignItems:"center",justifyContent:"center"},children:(0,O.jsxs)(S.default,{style:{width:60,height:60,backgroundColor:"white",alignItems:"center",justifyContent:"center"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:10,letterSpacing:1,color:F.grey1},children:"TABLE"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:1,color:F.grey1},children:s.params.t||""})]})}):(0,O.jsx)(S.default,{style:{position:"absolute",left:0,right:0,bottom:120,height:60,alignItems:"center",justifyContent:"center"},children:(0,O.jsxs)(S.default,{style:{width:60,height:60,backgroundColor:"white",alignItems:"center",justifyContent:"center"},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:10,letterSpacing:1,color:F.grey1},children:"TAKE"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:10,letterSpacing:1,color:F.grey1},children:"AWAY"})]})}),(0,O.jsxs)(S.default,{style:{position:"absolute",height:100,left:0,right:0,bottom:0,flexDirection:"row"},children:[(0,O.jsxs)(I.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},onPress:function(){return null!=d&&d.v.vipId?l.navigate("Menu"):l.navigate("Login")},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:14,letterSpacing:2,color:F.grey1},children:"START AS"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:2,color:F.grey1},children:"MEMBER"})]}),!(null!=d&&null!=(r=d.v)&&r.vipId)&&(0,O.jsx)(S.default,{style:{marginVertical:20,width:2,backgroundColor:F.grey9}}),!(null!=d&&null!=(o=d.v)&&o.vipId)&&(0,O.jsxs)(I.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},onPress:function(){return l.navigate("Menu")},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:14,letterSpacing:2,color:F.grey1},children:"START AS"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:2,color:F.grey1},children:"GUEST"})]})]})]})}}]),n}(d.Component);c.default.create({});function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var ne=function(e){(0,l.default)(n,e);var t=te(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={userId:"",mode:"USER",password:"",warning:null,sent:!1},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=this.props.navigation;this.sub=e.addListener("focus",this.didFocus.bind(this));var t=yield g.default.getItem("session");this.setState({session:JSON.parse(t)})}));return function(){return e.apply(this,arguments)}}()},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e=yield g.default.getItem("session");this.setState({session:JSON.parse(e)})}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.sub()}},{key:"doSearchSimple",value:function(){var e,t=this,n=this.props,r=(n.navigation,n.route,this.state),o=r.session,i=r.userId;if(""!==i){var l=null==(e=C[o.e])?void 0:e.service;fetch(l+"api/vendor/memberson/search-simple",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({searchString:i})}).then((function(e){return e.json()})).then((function(e){if(console.log(e),(null==e?void 0:e.length)>1)t.setState({warning:"Multiple records found. Please try again."});else if(0===(null==e?void 0:e.length))t.setState({warning:"Invalid email or phone. Please try again."});else if(1===(null==e?void 0:e.length)){var n,r,o;t.setState({warning:null,userId:"",selectedVip:{vipId:null==(n=e[0])?void 0:n.customerNumber,vipName:null==(r=e[0])?void 0:r.firstName,emailAddr:null==(o=e[0])?void 0:o.email},mode:"PASSWORD"},(function(){t.secondTextInput&&t.secondTextInput.focus()}))}}))}else this.firstTextInput.focus()}},{key:"doForget",value:function(){var e,t=this,n=this.props,r=(n.navigation,n.route,this.state),o=(r.userId,r.password,r.selectedVip),i=r.session,l=null==(e=C[i.e])?void 0:e.service;fetch(l+"api/vendor/memberson/forget",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({customerNumber:o.vipId})}).then((function(e){return e.json()})).then((function(e){t.setState({sent:!0})}))}},{key:"doVerify",value:function(){var e=(0,r.default)((function*(){var e,t=this,n=this.props,r=n.navigation,o=(n.route,this.state),i=(o.userId,o.password),l=o.selectedVip,s=o.session;if(""!==i){var a=null==(e=C[s.e])?void 0:e.service;fetch(a+"api/vendor/memberson/signin",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({openorderRecKey:s.o.openorder.recKey,customerNumber:l.vipId,password:i})}).then((function(e){return e.json()})).then((function(e){if(console.log(e),e.ErrorCode)t.setState({warning:e.Message});else{var n=s;n.v=l,n.o=e,g.default.setItem("session",JSON.stringify(n)),r.replace("Menu")}}))}else this.secondTextInput.focus()}));return function(){return e.apply(this,arguments)}}()},{key:"doRegister",value:function(){f.default.openURL("https://www.comoclub.com/signup?SP=SGLFSSNGDSY&location=SGLFSSNGDSY&Promo=TBORSG")}},{key:"render",value:function(){var e,t=this,n=this.props,r=(n.navigation,n.route,this.state),o=r.userId,i=(r.password,r.mode),l=r.warning,s=r.sent,a=r.selectedVip,d=r.session;return(0,O.jsxs)(S.default,{style:{flex:1,backgroundColor:"white",alignItems:"center",justifyContent:"center"},children:[(0,O.jsx)(R.default,{style:{width:200,height:200},source:{uri:null==(e=C[null==d?void 0:d.e])?void 0:e.login},resizeMode:"contain"}),(0,O.jsxs)(S.default,{style:{width:"90%"},children:[(0,O.jsxs)(S.default,{style:{},children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",color:"#003A63",paddingHorizontal:20,paddingBottom:5},children:"Email or Mobile No."}),(0,O.jsxs)(S.default,{style:re.searchContainer,children:[(0,O.jsx)(S.default,{style:re.searchIconContainer,children:(0,O.jsx)(N.default,{name:"user",size:18,color:F.grey5})}),(0,O.jsx)(B.default,{style:re.searchTextInput,autoCorrect:!1,disabled:"PASSWORD"===i,placeholder:"email or mobile",placeholderTextColor:F.grey5,ref:function(e){t.firstTextInput=e},onSubmitEditing:function(){return t.doSearchSimple()},defaultValue:o,onChangeText:function(e){return t.setState({userId:e})}})]}),(0,O.jsx)(I.default,{disabled:"PASSWORD"===i,onPress:function(){return t.doRegister()},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",color:"#003A63",paddingBottom:5,textAlign:"right",opacity:"PASSWORD"===i?.5:1},children:"Not a member? Register here."})})]}),"PASSWORD"===i&&(0,O.jsxs)(S.default,{children:[(0,O.jsx)(w.default,{style:{fontFamily:"demi",color:"#003A63",paddingHorizontal:20,paddingBottom:5},children:"Password"}),(0,O.jsxs)(S.default,{style:re.searchContainer,children:[(0,O.jsx)(S.default,{style:re.searchIconContainer,children:(0,O.jsx)(N.default,{name:"user",size:18,color:F.grey5})}),(0,O.jsx)(B.default,{style:re.searchTextInput,autoCorrect:!1,secureTextEntry:!0,placeholder:"password",placeholderTextColor:F.grey5,ref:function(e){t.secondTextInput=e},onChangeText:function(e){return t.setState({password:e})}})]}),(0,O.jsx)(I.default,{disabled:s,onPress:function(){return t.doForget()},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",color:"#003A63",paddingBottom:5,textAlign:"right",opacity:s?.5:1},children:s?"OTP sent to "+(null==a?void 0:a.emailAddr):"Send One-time Password"})})]}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",color:"red",paddingHorizontal:20,paddingBottom:5},children:l||" "}),(0,O.jsx)(I.default,{style:{width:"100%",height:60,marginBottom:100,alignItems:"center",justifyContent:"center",backgroundColor:"#003A63"},onPress:function(){"USER"===i?t.doSearchSimple():t.doVerify()},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:2,color:"white"},children:"USER"===i?"NEXT":"VERIFY"})})]})]})}}]),n}(d.Component),re=c.default.create({searchContainer:{height:50,borderRadius:5,backgroundColor:F.grey9,flexDirection:"row",marginBottom:10},searchIconContainer:{marginVertical:10,marginHorizontal:5,width:40,alignItems:"center",justifyContent:"center",borderRightWidth:1,borderRightColor:F.grey7},searchTextInput:{flex:1,paddingHorizontal:10,borderRadius:5,fontFamily:"regular",fontSize:20}});function oe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var ie=function(e){(0,l.default)(n,e);var t=oe(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=yield g.default.getItem("session");this.setState({session:e?JSON.parse(e):null})}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.props,n=(t.navigation,t.route,this.state.session);return(0,O.jsxs)(S.default,{style:{flex:1,backgroundColor:"white",alignItems:"center",justifyContent:"center"},children:[(null==n?void 0:n.e)&&(0,O.jsx)(R.default,{style:{height:40,width:80,margin:20},source:{uri:null==(e=C[n.e])?void 0:e.logo},resizeMode:"contain"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",marginHorizontal:20,textAlign:"center"},children:"Session expired or invalid link."}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",marginHorizontal:20,textAlign:"center"},children:"Please rescan a valid QR code or approach our friendly staff."})]})}}]),n}(d.Component);c.default.create({});function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var se=function(e){(0,l.default)(n,e);var t=le(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={loading:!0},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=this,t=(this.props.route,yield g.default.getItem("session")),n=yield g.default.getItem("masters");this.setState({session:t?JSON.parse(t):null,masters:n?JSON.parse(n):null},(function(){e.doGet()}))}));return function(){return e.apply(this,arguments)}}()},{key:"doGet",value:function(){var e,t=this.props,n=t.route,r=t.navigation,o=(this.state.session,C[n.params.e].service);fetch(o+"api/vendor/rdp/get-transaction-result?transactionId="+(null==n||null==(e=n.params)?void 0:e.transaction_id)).then((function(e){return e.json()})).then((function(e){console.log(e),"0"===e.response_code?r.navigate("Result",{e:n.params.e,t:n.params.t||"",r:n.params.r,s:"0"}):r.navigate("Result",{e:n.params.e,t:n.params.t||"",r:n.params.r,s:"1"})}))}},{key:"render",value:function(){var e=this.props,t=(e.navigation,e.route,this.state),n=t.loading;t.session,t.response,t.selectedOrder,t.masters;if(!n)return(0,O.jsx)(S.default,{style:{backgroundColor:"white"}})}}]),n}(d.Component);c.default.create({searchContainer:{height:50,borderRadius:5,backgroundColor:F.grey9,flexDirection:"row",margin:10},searchIconContainer:{marginVertical:10,marginHorizontal:5,width:40,alignItems:"center",justifyContent:"center",borderRightWidth:1,borderRightColor:F.grey7},searchTextInput:{flex:1,paddingHorizontal:10,borderRadius:5,fontFamily:"regular",fontSize:20}});function ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var de=function(e){(0,l.default)(n,e);var t=ae(n);function n(e){var r;return(0,o.default)(this,n),(r=t.call(this,e)).state={},r}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e=this,t=this.props.route,n=yield g.default.getItem("session"),r=yield g.default.getItem("masters");this.setState({session:n?JSON.parse(n):null,masters:r?JSON.parse(r):null},(function(){"0"===t.params.s&&e.doGet()}))}));return function(){return e.apply(this,arguments)}}()},{key:"doGet",value:function(){var e,t,n=this,r=this.props,o=(r.navigation,r.route),i=this.state.session,l=null==(e=C[null==i?void 0:i.e])?void 0:e.service;fetch(l+"api/openorders/"+(null==(t=o.params)?void 0:t.r)).then((function(e){return e.json()})).then((function(e){if(e.openorder){var t=i;t.o={},t.h.some((function(e){var t,n;return(null==e||null==(t=e.openorder)||null==(n=t.recKey)?void 0:n.toString())===o.params.r}))||t.h.push(e),g.default.setItem("session",JSON.stringify(t)),n.setState({session:t,selectedOrder:e})}}))}},{key:"render",value:function(){var e=this.props,t=e.navigation,n=e.route,r=this.state,o=r.session,i=(r.response,r.selectedOrder),l=r.masters;return(0,O.jsxs)(S.default,{style:{backgroundColor:"white",minHeight:"100%"},children:[(0,O.jsx)(A,{navigation:t,session:o}),"0"!==n.params.s&&(0,O.jsxs)(S.default,{style:{flex:1,backgroundColor:"white",alignItems:"center",justifyContent:"center"},children:[(0,O.jsx)(N.default,{name:"exclamationcircle",size:24,color:F.reserved}),(0,O.jsx)(w.default,{style:{marginTop:10,fontFamily:"demi",marginHorizontal:20,textAlign:"center"},children:"Payment Unsuccessful"}),(0,O.jsx)(w.default,{style:{fontFamily:"demi",marginHorizontal:20,textAlign:"center"},children:"Please try again or approach our friendly staff."})]}),i&&"0"===n.params.s&&(0,O.jsx)(U,{selectedOrder:i,masters:l}),(0,O.jsx)(I.default,{style:{margin:10,height:60,borderRadius:5,backgroundColor:F.grey8,alignItems:"center",justifyContent:"center"},onPress:function(){return t.navigate("Menu")},children:(0,O.jsx)(w.default,{style:{fontFamily:"demi",fontSize:20,letterSpacing:2,color:F.grey1},children:"CONTINUE"})})]})}}]),n}(d.Component);c.default.create({searchContainer:{height:50,borderRadius:5,backgroundColor:F.grey9,flexDirection:"row",margin:10},searchIconContainer:{marginVertical:10,marginHorizontal:5,width:40,alignItems:"center",justifyContent:"center",borderRightWidth:1,borderRightColor:F.grey7},searchTextInput:{flex:1,paddingHorizontal:10,borderRadius:5,fontFamily:"regular",fontSize:20}});function ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var ce=(0,h.default)(),fe={config:{screens:{Start:{path:"bistro-ext/start"},Login:{path:"bistro-ext/login"},Menu:{path:"bistro-ext/menu"},Item:{path:"bistro-ext/item"},Order:{path:"bistro-ext/order"},Cart:{path:"bistro-ext/cart"},Redirect:{path:"bistro-ext/redirect"},Result:{path:"bistro-ext/result"},Error:{path:"*"}}}},me=function(e){(0,l.default)(s,e);var t=ue(s);function s(){var e;(0,o.default)(this,s);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={error:!1},e}return(0,i.default)(s,[{key:"componentDidMount",value:function(){var e=(0,r.default)((function*(){var e,t,r=this;yield p.loadAsync({regular:n(5448),demi:n(2510),bold:n(763),light:n(3820)});var o=yield f.default.getInitialURL(),i=yield g.default.getItem("session");i&&(i=JSON.parse(i)),console.log("app mounted",o,null==(e=i)||null==(t=e.o)?void 0:t.openorder);var l=new BroadcastChannel("tab");l.postMessage("another-tab"),l.addEventListener("message",(function(e){"another-tab"===e.data&&r.setState({error:!0})})),window.addEventListener("focus",this.didFocus)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("focus",this.didFocus)}},{key:"didFocus",value:function(){var e=(0,r.default)((function*(){var e,t,n,r,o,i,l,s=yield f.default.getInitialURL(),a=yield g.default.getItem("session");(a&&(a=JSON.parse(a)),console.log("app focused",s,null==(e=a)||null==(t=e.o)?void 0:t.openorder),null!=(n=a)&&null!=(r=n.o)&&r.openorder)&&(v()().diff(v()(null==(o=a)||null==(i=o.o)||null==(l=i.openorder)?void 0:l.seatTime),"minutes")>30&&(yield g.default.removeItem("session"),window.location.href=s.split("bistro-ext")[0]+"bistro-ext/"))}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.error?(0,O.jsx)(ie,{}):(0,O.jsxs)(m.default,{theme:{dark:!1,colors:{background:"white"}},linking:fe,children:[(0,O.jsx)(u.default,{hidden:!0}),(0,O.jsxs)(ce.Navigator,{screenOptions:{headerShown:!1,animation:"none",gestureEnabled:!1},children:[(0,O.jsx)(ce.Screen,{name:"Start",component:ee,options:ee.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Login",component:ne,options:ne.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Menu",component:M,options:M.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Item",component:E,options:E.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Cart",component:Y,options:Y.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Order",component:Q,options:Q.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Error",component:ie,options:ie.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Redirect",component:se,options:se.navigationOptions}),(0,O.jsx)(ce.Screen,{name:"Result",component:de,options:de.navigationOptions})]})]})}}]),s}(d.Component);c.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}})},6700:(e,t,n)=>{var r={"./af":4506,"./af.js":4506,"./ar":9687,"./ar-dz":2887,"./ar-dz.js":2887,"./ar-kw":6307,"./ar-kw.js":6307,"./ar-ly":1664,"./ar-ly.js":1664,"./ar-ma":9926,"./ar-ma.js":9926,"./ar-sa":5207,"./ar-sa.js":5207,"./ar-tn":2912,"./ar-tn.js":2912,"./ar.js":9687,"./az":5011,"./az.js":5011,"./be":5997,"./be.js":5997,"./bg":4427,"./bg.js":4427,"./bm":5385,"./bm.js":5385,"./bn":7703,"./bn-bd":7002,"./bn-bd.js":7002,"./bn.js":7703,"./bo":9841,"./bo.js":9841,"./br":5642,"./br.js":5642,"./bs":9038,"./bs.js":9038,"./ca":3512,"./ca.js":3512,"./cs":9497,"./cs.js":9497,"./cv":6479,"./cv.js":6479,"./cy":9318,"./cy.js":9318,"./da":7229,"./da.js":7229,"./de":3460,"./de-at":1044,"./de-at.js":1044,"./de-ch":6445,"./de-ch.js":6445,"./de.js":3460,"./dv":2096,"./dv.js":2096,"./el":6048,"./el.js":6048,"./en-au":4301,"./en-au.js":4301,"./en-ca":6855,"./en-ca.js":6855,"./en-gb":761,"./en-gb.js":761,"./en-ie":6127,"./en-ie.js":6127,"./en-il":9157,"./en-il.js":9157,"./en-in":7199,"./en-in.js":7199,"./en-nz":1511,"./en-nz.js":1511,"./en-sg":7309,"./en-sg.js":7309,"./eo":2160,"./eo.js":2160,"./es":8582,"./es-do":1885,"./es-do.js":1885,"./es-mx":8131,"./es-mx.js":8131,"./es-us":6962,"./es-us.js":6962,"./es.js":8582,"./et":8890,"./et.js":8890,"./eu":7704,"./eu.js":7704,"./fa":2562,"./fa.js":2562,"./fi":877,"./fi.js":877,"./fil":4246,"./fil.js":4246,"./fo":8341,"./fo.js":8341,"./fr":9867,"./fr-ca":2347,"./fr-ca.js":2347,"./fr-ch":7683,"./fr-ch.js":7683,"./fr.js":9867,"./fy":1982,"./fy.js":1982,"./ga":3905,"./ga.js":3905,"./gd":3443,"./gd.js":3443,"./gl":6905,"./gl.js":6905,"./gom-deva":1324,"./gom-deva.js":1324,"./gom-latn":1890,"./gom-latn.js":1890,"./gu":7134,"./gu.js":7134,"./he":6835,"./he.js":6835,"./hi":1394,"./hi.js":1394,"./hr":3564,"./hr.js":3564,"./hu":6269,"./hu.js":6269,"./hy-am":7269,"./hy-am.js":7269,"./id":4254,"./id.js":4254,"./is":8699,"./is.js":8699,"./it":8301,"./it-ch":5060,"./it-ch.js":5060,"./it.js":8301,"./ja":4642,"./ja.js":4642,"./jv":2168,"./jv.js":2168,"./ka":4501,"./ka.js":4501,"./kk":9537,"./kk.js":9537,"./km":5808,"./km.js":5808,"./kn":4881,"./kn.js":4881,"./ko":2951,"./ko.js":2951,"./ku":2452,"./ku.js":2452,"./ky":1853,"./ky.js":1853,"./lb":7639,"./lb.js":7639,"./lo":4502,"./lo.js":4502,"./lt":874,"./lt.js":874,"./lv":8237,"./lv.js":8237,"./me":7878,"./me.js":7878,"./mi":4234,"./mi.js":4234,"./mk":7535,"./mk.js":7535,"./ml":3896,"./ml.js":3896,"./mn":3046,"./mn.js":3046,"./mr":927,"./mr.js":927,"./ms":7224,"./ms-my":6332,"./ms-my.js":6332,"./ms.js":7224,"./mt":4866,"./mt.js":4866,"./my":4206,"./my.js":4206,"./nb":6723,"./nb.js":6723,"./ne":5097,"./ne.js":5097,"./nl":7529,"./nl-be":1355,"./nl-be.js":1355,"./nl.js":7529,"./nn":296,"./nn.js":296,"./oc-lnc":4802,"./oc-lnc.js":4802,"./pa-in":7057,"./pa-in.js":7057,"./pl":9850,"./pl.js":9850,"./pt":5552,"./pt-br":3726,"./pt-br.js":3726,"./pt.js":5552,"./ro":1717,"./ro.js":1717,"./ru":9117,"./ru.js":9117,"./sd":1742,"./sd.js":1742,"./se":2049,"./se.js":2049,"./si":3329,"./si.js":3329,"./sk":7619,"./sk.js":7619,"./sl":6707,"./sl.js":6707,"./sq":4281,"./sq.js":4281,"./sr":436,"./sr-cyrl":3408,"./sr-cyrl.js":3408,"./sr.js":436,"./ss":7500,"./ss.js":7500,"./sv":6950,"./sv.js":6950,"./sw":4222,"./sw.js":4222,"./ta":3746,"./ta.js":3746,"./te":1130,"./te.js":1130,"./tet":4740,"./tet.js":4740,"./tg":3378,"./tg.js":3378,"./th":628,"./th.js":628,"./tk":2622,"./tk.js":2622,"./tl-ph":100,"./tl-ph.js":100,"./tlh":2871,"./tlh.js":2871,"./tr":3600,"./tr.js":3600,"./tzl":8985,"./tzl.js":8985,"./tzm":3627,"./tzm-latn":1145,"./tzm-latn.js":1145,"./tzm.js":3627,"./ug-cn":4790,"./ug-cn.js":4790,"./uk":7712,"./uk.js":7712,"./ur":9529,"./ur.js":9529,"./uz":9141,"./uz-latn":1737,"./uz-latn.js":1737,"./uz.js":9141,"./vi":8205,"./vi.js":8205,"./x-pseudo":697,"./x-pseudo.js":697,"./yo":7826,"./yo.js":7826,"./zh-cn":3994,"./zh-cn.js":3994,"./zh-hk":6892,"./zh-hk.js":6892,"./zh-mo":3884,"./zh-mo.js":3884,"./zh-tw":5136,"./zh-tw.js":5136};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=6700},763:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/AvenirNextLTPro-Bold.711a4eb654bf1139f123.otf"},2510:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/AvenirNextLTPro-Demi.2a0cec709a4166a967dc.otf"},3820:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/AvenirNextLTPro-It.3e062c6caf04ecafa42c.otf"},5448:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/AvenirNextLTPro-Regular.94f2f163d4b698242fef.otf"},8021:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/login-glow.1dd2ed14987941ab51db.png"},8295:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/logo-glow.dc513e70b7208b960ea7.png"},3921:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/wall-glow.dc354fa0810bd9480ed8.jpg"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,i)=>{if(!r){var l=1/0;for(u=0;u<e.length;u++){for(var[r,o,i]=e[u],s=!0,a=0;a<r.length;a++)(!1&i||l>=i)&&Object.keys(n.O).every((e=>n.O[e](r[a])))?r.splice(a--,1):(s=!1,i<l&&(l=i));if(s){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,o,i]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="./",(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,i,[l,s,a]=r,d=0;if(l.some((t=>0!==e[t]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(a)var u=a(n)}for(t&&t(r);d<l.length;d++)i=l[d],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[937],(()=>n(9484)));r=n.O(r)})();
//# sourceMappingURL=main.8707d2b0.js.map